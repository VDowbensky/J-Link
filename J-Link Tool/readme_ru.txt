JLinkTool by UniSoft v1.00
Только для "J-Link V10" и "J-Link V11"!

JLinkTool.exe <команда> [<аргументы>] [<флаги>]

[команды]

--test                              : Просто тест для проверки Уязвимости, 
                                    :   используйте сначала для проверки работоспособности эксплоита.
                                    :   Светодиоды J-Link'а должны моргать (максимум примерно 30 секунд).

--keygen                            : Генератор лицензий, отображает все сгенерированные лицензии... 

--eraseots 0                        : стирает лицензии (из OTS)
--eraseots 1                        : стирает лицензии и OEM штамп (используйте чтобы избавиться от EDU)
--eraseots 2                        : стирает лицензии и устанавливает OEM штамп: "SEGGER-EDU"
--eraseots 4                        : стирает лицензии и добавлякт лицензии "FlashBP" и "GDB"
--eraseots 7                        : возврат к EDU

--eraselicenses                     : стирает устанавливаемые лицензии из CONFIG и из реестра: 
                                    :   HKEY_CURRENT_USER\Software\SEGGER\License_xxx
                                    :   не трогает OTS

--setoem SEGGER-EDU                 : устанавливает OEM штамп.

--addlic  JFlash                    : добавляет встроенные лицензии. (в OTS)
--addlic #JFlash                    : генерирует и добавляет встроенные лицензии (в CONFIG)
--addlic @JFlash                    : генерирует и добавляет устанавливаемые лицензии (в реестр)

--dump  <addr>  <size> <file>       : считать прошивку 
--dump 1A000000 80000 file1.bin     : 
--dump 1B000000 80000 file2.bin     : LPC4337 используемый в клонах имеет 2 банка памяти 
 
--dumponce                          : просто флаг; не сливать дамп если файл уже существует.

--pause                             : ждать нажатие любой клавиши "Press any key..." 


Пример:
JLinkTool.exe --eraseots 5 --dumponce --dump 1A000000 80000 ROM_1A000000_80000_V{V}_SN{S}.bkp --addlic @FlashDL --addlic @JFlash --addlic @RDI --pause
делает бэкап в файл: ROM_1A000000_80000_V10_SN12345678.bkp (если файл не существует)
стирает OEM штамп и лицензии, добавляет лицензии: "FlashBP" и "GDB",
добавляет лицензии в реестр: FlashDL, JFlash, RDI
ожидает нажатие любой клавиши "Press any key..." 

======[ некоторая информация ]=====================================================================

OTS это программно реализованная однократно программируемая память (ОТП),
т.е. биты могут быть только сброшены в 0, но не обратно.
В коде даже нет процедуры стирания страницы.
Для V10 и V11 OTS занимает одну страницу 512 байт.
Во второй половине хранится сертификат (подписанные серийный номер и уникальный идентификатор контроллера),
вот почему невозможно поменять серийный номер, собственно как и сам контроллер, залитый дамп в другой контроллера работать не будет! 

CONFIG это обычная память, в основном хранит настройки. 

Лицензии (они же features) погут храниться в разных местах
  1. Встроенные лицензии хранятся в OTS памяти и не могут быть стерты!
  2. В реестре: HKEY_CURRENT_USER\Software\SEGGER\License_xxx
  3. В CONFIG памяти J-Link'а (но похоже это более не работает, по крайней мере JFlash их не видит).
  
Существует только 5 лицензий: "FlashBP", "GDB", "FlashDL", "JFlash", "RDI"
любой другое значение приведет к J-Link defective!
Для J-Link V10 и V11 с Серийными номерами:
26xxxxxxx, 5xxxxxxx, 82xxxxxxx, 
не разрешены встроенные лицензии "JFlash" и "RDI"!

OEM штамп должен быть одним из:
"IAR", "IARKS", "SEGGERKS", "DIGI-LINK", "J-Link-CE", "MIDAS", "ADI", "SAM-ICE", "SEGGER-EDU"

===============================================================================================
Best regards, UNIS  
iarkgen@gmail.com
08.08.2022



